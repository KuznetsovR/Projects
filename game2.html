<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="game.css" type="text/css">
    <title>game</title>
</head>
<body>
    <table id='table'>
        <tr id='1'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
        <tr id='2'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
        <tr id='3'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
        <tr id='4'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
        <tr id='5'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
        <tr id='6'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
        <tr id='7'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
        <tr id='8'>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
            <td class='pixel'></td>
        </tr>
    </table>

    <script>
        let pixels = document.querySelectorAll('.pixel');
        let px =  Array.from(pixels);
        let queue = 1;
        let table = document.getElementById('table');
        let current = 'red';
        let opposite = 'blue';
        for (let pixel of pixels){
                pixel.onclick = function(){
                    let n = px.findIndex(function (val) {
                        return val === pixel;
                    })
                
                function check(n, shift){
                    let n1=n;

                    let r = n1%8;
                    let r1 = (n1+shift)%8;
                    let b = parseInt((n1+shift)/8);
                    k = 0;
                    while ((Math.abs(r-r1)<=1) && ((b>=0) && (b<8))) {
                        if(px[n1+shift].style.backgroundColor===opposite){
                            n1 += shift;
                            r = n1%8;
                            r1 = (n1+shift)%8;
                            b = (n1+shift)/8;
                            k++;    
                        }else if(px[n1+shift].style.backgroundColor===current){
                            n1 =n;
                            for(i=0;i<k;i++){
                                n1+=shift;
                                px[n1].style.backgroundColor = current;
                            }
                            return;                         
                        }else{
                            return;
                        }
                    }
                    return;
                }

                check(n, -9);
                check(n, -8);
                check(n, -7);
                check(n, 1);
                check(n, 9);
                check(n, 8);
                check(n, 7);
                check(n, -1);

                [current, opposite] = [opposite, current];
                if (queue%2>0){
                    pixel.style.backgroundColor = 'red';
                    
                } else{
                    pixel.style.backgroundColor = 'blue';
                }
            queue+=1;
            }
        } 
    </script>
</body>
</html>
